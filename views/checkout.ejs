<body>
  <%- include('hero.ejs') %>
  <section class="checkout spad">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <h6>
            <span class="icon_tag_alt"></span> Have a coupon?
            <a href="#">Click here</a> to enter your code
          </h6>
        </div>
      </div>
      <div class="checkout__form">
        <h4>Billing Details</h4>
        <form action="#">
          <div class="row">
            <% console.log(userSessionExists); %> <% if (!userSessionExists) {
            %> <%- include('billingform.ejs') %> <% } %> <% if
            (userSessionExists) { %> <%- include('billingoptions.ejs') %> <% }
            %>

            <div class="col-lg-4 col-md-6">
              <div class="checkout__order">
                <h4>Your Order</h4>
                <div class="checkout__order__products">
                  Products <span>Total</span>
                </div>
                <ul id="cartItemList">
                  <!-- Cart items will be dynamically added here -->
                </ul>

                <div class="checkout__order__total">
                  Total <span>KES 00.00</span>
                </div>
                <div class="checkout__input__checkbox">
                  <label for="acc-or">
                    Create an account?
                    <input type="checkbox" id="acc-or" />
                    <span class="checkmark"></span>
                  </label>
                </div>
                <p>Create account for Easy checkout next time.</p>
                <div class="checkout__input__checkbox">
                  <label for="payment">
                    Mpesa
                    <input type="checkbox" id="payment" />
                    <span class="checkmark"></span>
                  </label>
                </div>
                <div class="checkout__input__checkbox">
                  <label for="paypal">
                    Paypal
                    <input type="checkbox" id="paypal" />
                    <span class="checkmark"></span>
                  </label>
                </div>
                <button type="submit" class="site-btn">PLACE ORDER</button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </section>
  <script>
    const storedCartItems = JSON.parse(localStorage.getItem("cartItems")) || [];
    const cartItemList = document.getElementById("cartItemList");
    let totalPrice = 0;
    storedCartItems.forEach((item) => {
      const liElement = document.createElement("li");
      const itemTotalPrice = (item.price * item.quantity).toFixed(2);
      totalPrice += item.price * item.quantity;
      liElement.innerHTML = `${item.product_name} <span>KES ${itemTotalPrice}</span>`;
      cartItemList.appendChild(liElement);
    });
    const totalElement = document.querySelector(".checkout__order__total span");
    totalElement.textContent = `KES ${totalPrice.toFixed(2)}`;
  </script>
</body>
